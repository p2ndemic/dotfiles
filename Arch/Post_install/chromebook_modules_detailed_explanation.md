| Модуль                   | Назначение                                                                                                    | Функциональность                                                                                                                                                                                                                                                                                                                                                                                       | Необходимость |
| :----------------------- | :------------------------------------------------------------------------------------------------------------ | :----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----------: |
| `chromeos_acpi.c`        | Чтение специфичных для ChromeOS ACPI объектов и методов.                                                      | Обращается к ACPI устройству `GGL0001` или `GOOG0016`. Читает значения ACPI методов/объектов, таких как `BINF`, `FWID`, `HWID`, `VDAT`, `GPIO`, `FMAP`, `FRID` и др. Экспортирует полученные значения (обычно строки или числа) через sysfs в `/sys/firmware/acpi/chromeos/`.                                                                                                                |       ✓       |
| `cros_charge-control.c`  | Управление режимами зарядки батареи через ChromeOS EC.                                                         | Использует команду EC `EC_CMD_CHARGE_CONTROL` для установки режима зарядки: `NORMAL` (автоматический), `IDLE` (запретить зарядку) или `DISCHARGE` (принудительная разрядка). Если EC поддерживает (версия команды >= 2), позволяет устанавливать пороги начала и конца зарядки. Интегрируется с подсистемой `power_supply` через ACPI battery hook, добавляя свойства управления в sysfs.                 |       ✓       |
| `cros_ec.c`              | Ядро фреймворка ChromeOS EC. Содержит общие функции и обработку прерываний.                                  | Включает основную логику регистрации/дерегистрации устройств EC. Содержит обработчик прерываний, который получает уведомления от EC и инициирует обработку событий. Включает функции для получения событий от EC, их обработки и координации suspend/resume.                                                                                                                                  |       ✓       |
| `cros_ec_chardev.c`      | Создает символьное устройство (`/dev/cros_ec`) для взаимодействия с ChromeOS EC из пользовательского пространства. | Предоставляет интерфейс `ioctl` для: Отправки произвольных команд EC (`IOCXCMD`), Чтения из областей памяти EC (`IOCRDMEM`), Подписки на MKBP события (`IOCEVENTMASK`), которые затем можно читать через `read()`.                                                                                                                                                                                      |       ✓       |
| `cros_ec_debugfs.c`      | Создает интерфейс в debugfs для отладки ChromeOS EC.                                                           | Предоставляет доступ к консольному логу EC (через опрос), информации о панике (`panicinfo`), статусу портов PD (`pdinfo`). Также показывает результат последнего выхода из сна и позволяет настроить таймаут suspend.                                                                                                                                                                          |       ✓       |
| `cros_ec_dev.c`          | Основной драйвер Multi-Function Device (MFD) для ChromeOS EC.                                                  | Регистрирует основное устройство EC. Определяет его возможности (`EC_FEATURE_*`). На основе обнаруженных возможностей создает дочерние platform-устройства для отдельных функций (клавиатура, сенсоры, Type-C, RTC, chardev, sysfs, debugfs и т.д.). Создает устройство в `/sys/class/chromeos/`.                                                                                               |       ✓       |
| `cros_ec_hwmon.c`        | Драйвер для мониторинга аппаратных сенсоров (температура, вентиляторы) через ChromeOS EC.                       | Читает данные с температурных датчиков и скорости вентиляторов из памяти EC (`EC_MEMMAP_*`). Предоставляет данные через стандартный интерфейс HWMON в sysfs. Запрашивает имена сенсоров у EC.                                                                                                                                                                                                     |       ✓       |
| `cros_ec_keyb.c`         | Драйвер клавиатуры для ChromeOS EC.                                                                            | Обрабатывает ввод с матричной клавиатуры, применяет фильтр "фантомных" нажатий (опционально), обрабатывает отдельные кнопки (питание, громкость) и переключатели (крышка, режим планшета), генерируя события ввода Linux. Использует протокол `cros_ec_proto`.                                                                                                                                   |       ✓       |
| `cros_ec_lpc.c`          | Реализация протокола обмена данными с ChromeOS EC через шину LPC.                                                | Обеспечивает транспортную функцию для обмена командами/пакетами с EC по LPC. Предоставляет доступ к памяти EC. Обрабатывает ACPI уведомления от EC. Может использовать `cros_ec_lpc_mec.c` для EC от Microchip. Управляет suspend/resume.                                                                                                                                                            |       ✓       |
| `cros_ec_sensorhub.c`    | Драйвер хаба сенсоров на базе ChromeOS EC.                                                                      | Обнаруживает сенсоры (акселерометр, гироскоп и т.д.), подключенные к EC. Регистрирует для них platform-устройства. Инициализирует обработку FIFO (`cros_ec_sensorhub_ring`), если EC поддерживает эту функцию.                                                                                                                                                                                 |       ✓       |
| `cros_ec_sensors_core.c` | Общие базовые функции и логика инициализации для драйверов сенсоров EC в рамках фреймворка IIO.                 | Инициализирует структуру состояния. Управляет связью с EC для команд сенсоров. Предоставляет общие функции для чтения данных. Реализует колбэки IIO (частота, калибровка, ID). Предоставляет обработчик триггера IIO. Регистрирует колбэки для FIFO. Настраивает буферы IIO. Управляет атрибутами sysfs для FIFO.                                                                        |       ✓       |
| `cros_ec_sysfs.c`        | Предоставляет интерфейс sysfs для управления некоторыми функциями ChromeOS EC.                                    | Создает файлы в sysfs для: перезагрузки EC (`reboot`), получения версий (`version`), информации о flash (`flashinfo`), управления углом пробуждения клавиатуры (`kb_wake_angle`).                                                                                                                                                                                                          |       ✓       |
| `cros_ec_typec.c`        | Основной драйвер для управления портами USB Type-C через ChromeOS EC.                                           | Регистрирует порты Type-C. Обнаруживает партнеров/кабели. Обрабатывает PD события. Выполняет Discovery (SOP/SOP'). Регистрирует Alternate Modes. Настраивает mux/retimer/роли. Обрабатывает VDM.                                                                                                                                                                                               |       ✓       |
| `cros_kbd_led_backlight.c`| Драйвер для управления подсветкой клавиатуры.                                                                   | Регистрирует LED-устройство `chromeos::kbd_backlight`. Управляет яркостью через ACPI (`GOOG0002`) или команды EC PWM (`EC_CMD_PWM_SET_KEYBOARD_BACKLIGHT`).                                                                                                                                                                                                                                    |       ✓       |
| `cros_typec_switch.c`    | Управление мультиплексорами (mux) и ретаймерами (retimer) USB Type-C, контролируемыми ChromeOS EC.              | Предоставляет интерфейсы `typec_mux_ops`/`typec_retimer_ops` для переключения в нужный режим (USB, DP, TBT, Safe). Использует команду `EC_CMD_TYPEC_CONTROL` и ожидает подтверждения от EC.                                                                                                                                                                                                       |       ✓       |
| `cros_usbpd-charger.c`   | Драйвер класса `power_supply` для зарядных устройств USB PD и выделенных зарядных устройств, управляемых EC.      | Регистрирует устройства `power_supply` в sysfs. Запрашивает у EC статус, возможности, тип зарядного устройства. Предоставляет свойства (`online`, `status`, `voltage_now` и др.) через sysfs. Позволяет устанавливать лимиты входного тока/напряжения. Реагирует на события PD.                                                                                                               |       ✓       |
| `cros_usbpd_logger.c`    | Драйвер для логирования событий USB Power Delivery.                                                             | Периодически опрашивает EC (`EC_CMD_PD_GET_LOG_ENTRY`) и выводит события PD в системный журнал (`dmesg`).                                                                                                                                                                                                                                                                                      |       ✓       |
| `cros_usbpd_notify.c`    | Получатель и ретранслятор событий USB Power Delivery (PD) от ChromeOS EC.                                       | Регистрирует обработчик уведомлений (ACPI notify или MKBP event) для получения сигналов от EC о событиях PD. Запрашивает у EC детальный статус и передает его другим драйверам через notifier chain.                                                                                                                                                                                          |       ✓       |
| `extcon-usbc-cros-ec.c`  | Драйвер External Connector (extcon) для портов USB-C, управляемых ChromeOS EC.                                  | Определяет состояние подключения, роли данных/питания, DP alt mode, mux SuperSpeed через команды EC и сообщает об этом ядру через `extcon`. Реагирует на события от `cros_usbpd_notify`.                                                                                                                                                                                                  |       ✓       |
| `gpio-cros-ec.c`         | Предоставляет интерфейс GPIO для управления линиями ввода/вывода на ChromeOS EC.                                  | Регистрирует `gpio_chip`. Позволяет получать/устанавливать значение и направление GPIO через команды EC (`EC_CMD_GPIO_GET/SET`). Имена GPIO линий запрашиваются у EC.                                                                                                                                                                                                                         |       ✓       |
| `leds-cros_ec.c`         | Драйвер для управления светодиодами (LED), контролируемыми ChromeOS EC.                                         | Регистрирует LED-устройства (`leds` subsystem). Использует команду `EC_CMD_LED_CONTROL` для установки яркости/цвета. Поддерживает авто-режим (`chromeos-auto`). Определяет доступные цвета и максимальную яркость для каждого LED.                                                                                                                                                         |       ✓       |
| `pwm-cros-ec.c`          | Драйвер PWM-чипа, предоставляющий доступ к PWM-каналам, управляемым ChromeOS EC.                                  | Регистрирует `pwm_chip` в стандартном фреймворке Linux PWM. Использует команды EC (`EC_CMD_PWM_SET/GET_DUTY`) для установки/получения скважности. Поддерживает адресацию по индексу или типу. Период фиксирован. Определяет количество PWM-каналов путем опроса.                                                                                                                          |       ✓       |
| `cros_ec_codec.c`        | ASoC (ALSA System on Chip) кодек-драйвер для аудио-функций, реализуемых ChromeOS EC.                             | Предоставляет ASoC кодек-компоненты и DAI. Управляет: цифровыми микрофонами (DMIC gain), приемом I2S RX (формат, частота), функцией Wake-on-Voice (WoV - вкл/выкл, загрузка модели, получение аудио через команды или общую память).                                                                                                                                                         |       ✓       |
| `cros_ec_lpc_mec.c`      | Реализация низкоуровневого ввода/вывода для EC от Microchip (MEC) через интерфейс LPC.                            | Предоставляет функции для чтения/записи данных в память EC Microchip через протокол доступа к EMI по LPC. Управляет мьютексами (включая ACPI AML). Используется `cros_ec_lpc.c`.                                                                                                                                                                                                                 |       ✓       |
| `cros_ec_sensorhub_ring.c`| Обработка FIFO (First-In, First-Out) буфера для данных сенсоров от EC.                                          | Вызывается при событии `EC_MKBP_EVENT_SENSOR_FIFO`. Считывает данные из FIFO EC. Обрабатывает сэмплы: корректирует временные метки (используя фильтр), обрабатывает переполнение счетчиков времени, интерполирует метки для "пачек" сэмплов, передает данные драйверу сенсора через колбэк.                                                                                                     |       ✓       |
